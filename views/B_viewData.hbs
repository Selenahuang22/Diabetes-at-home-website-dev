 <section id="patientData">

    <!-- patient personal information section-->
    
    <section id="directP">
        <h2><a href={{home}} class="fontBlueNormal">Home</a> > <a href="" class="fontBlueNormal">View All Data</a></h2>
        <h2>Patient: {{patient.first_name}} {{patient.last_name}}</h2>
    </section>    
    
    <section id="backgroundColor">
        <table id="dataTables">
            <thead>
                <tr>
                    <th> <p>Date</p> </th>
                    <th> <p>Blood Glucose Level (in mmol/L)</p> </th>
                    <th> <p>Weight (in kg)</p> </th>
                    <th> <p>Number of Insulin Doses Taken</p> </th>
                    <th> <p>Exercises (step count)</p> </th>
                </tr>
            </thead>
            <tbody id="tableScroll">      
                {{#each date}}
                <tr>
                    <td class="fontBlueNormal">{{this.date}}</td>
                    <td class= {{#if (is_in_dangRange_ver2 this.bgl)}}"fontRed"{{else}}"fontBlueNormal"{{/if}}>{{this.bgl.value}}</td>
                    <td class= {{#if (is_in_dangRange_ver2 this.weight)}}"fontRed"{{else}}"fontBlueNormal"{{/if}}>{{this.weight.value}}</td>
                    <td class= {{#if (is_in_dangRange_ver2 this.insulin)}}"fontRed"{{else}}"fontBlueNormal"{{/if}}>{{this.insulin.value}}</td>
                    <td class= {{#if (is_in_dangRange_ver2 this.exercise)}}"fontRed"{{else}}"fontBlueNormal"{{/if}}>{{this.exercise.value}}</td>
                </tr>
                               
                {{/each}}          

            </tbody>
        </table>

        <section id="tableNote">
            <p>Note:<br>
            <tag class="fontRed">x</tag> means this data entry is required for this patient, but he/she hasn't entered yet.<br>
            <tag class="fontBlueNormal">x</tag> means this data entry is not required for this patient.
            </p>
        </section>

        <section id="graphSelect">
            <form action="" method="">
                <select name="display" onchange="selectInput(this)">
                    <option value="Blood">Blood Glucose Level</option>
                    <option value="Weight">Weight</option>
                    <option value="Number">Number Of Insulin Doses Taken</option>
                    <option value="Exercise">Exercise</option>
                </select>
            </form> 
            <section id="chart"></section>              
        </section>
        
    </section>
    
</section>

<script src="https://echarts.baidu.com/build/dist/echarts-all.js"></script>
<script type="text/javascript">
    var output = document.getElementsByName("display")[0].value;
    draw(output);
    function selectInput(choose){
        draw(choose.value);
    }
    function draw(output){
        var time = new Array();
        var mydata = new Array();

        var tab = document.getElementById("tableScroll");
        var rows = [];
        if (tab) {
            rows = tab.rows;
        }
        for(var i = 0; i < rows.length; i++){
            if (output === "Blood" && !(rows[i].cells[1].innerHTML === 'x')) {
                time.push(rows[i].cells[0].innerHTML);
                mydata.push(rows[i].cells[1].innerHTML);
            } else if (output === "Weight" && !(rows[i].cells[2].innerHTML === 'x')){
                time.push(rows[i].cells[0].innerHTML);
                mydata.push(rows[i].cells[2].innerHTML);
            } else if (output === "Number" && !(rows[i].cells[3].innerHTML === 'x')){
                time.push(rows[i].cells[0].innerHTML);
                mydata.push(rows[i].cells[3].innerHTML);
            } else if (output === "Exercise" && !(rows[i].cells[4].innerHTML === 'x')) {
                time.push(rows[i].cells[0].innerHTML);
                mydata.push(rows[i].cells[4].innerHTML);
            }
        }
        
        var myChart = echarts.init(document.getElementById('chart'));
        var option = {
            noDataLoadingOption: {
                text: "missing data",
            },
            dataZoom: {
                type: "slider", show: true, start: 0, end: 100,
            },
            xAxis: [
                {
                    data: time,
                }
            ],
            yAxis: [
                {
                    scale: true,
                }
            ],
            series: [
                {
                    name: "data",
                    type: "line",
                    data: mydata,
                }
            ],
        }
        myChart.setOption(option);
    }
    
</script>